<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
           xsi:type="TaskPaneApp">
  <Id>7b9e5d2d-2d3c-4a8c-9f0a-2db9a9e0a002</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>AddNap</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>
  <DisplayName DefaultValue="Word Tiles Add-in"/>
  <Description DefaultValue="Tiles with Jinja-style placeholders"/>

  <IconUrl DefaultValue="https://addnap.github.io/DocxBuilderWord/web/assets/icon-32.png"/>
  <HighResolutionIconUrl DefaultValue="https://addnap.github.io/DocxBuilderWord/web/assets/icon-80.png"/>
  <SupportUrl DefaultValue="https://addnap.github.io/DocxBuilderWord/"/>

  <AppDomains>
    <AppDomain>https://addnap.github.io</AppDomain>
  </AppDomains>

  <Hosts>
    <Host Name="Document"/>
  </Hosts>

  <Requirements>
    <Sets DefaultMinVersion="1.1">
      <Set Name="WordApi" MinVersion="1.3"/>
    </Sets>
  </Requirements>

  <DefaultSettings>
    <SourceLocation DefaultValue="https://addnap.github.io/DocxBuilderWord/web/taskpane.html"/>
  </DefaultSettings>

  <Permissions>ReadWriteDocument</Permissions>

  <!-- Uwaga: tu ustawiamy DOMYŚLNĄ przestrzeń nazw dla VersionOverrides -->
  <VersionOverrides xmlns="http://schemas.microsoft.com/office/taskpaneappversionoverrides"
                    xsi:type="VersionOverridesV1_0">
    <Hosts>
      <Host xsi:type="Document">
        <DesktopFormFactor>
          <FunctionFile resid="Functions.Url"/>

          <ExtensionPoint xsi:type="PrimaryCommandSurface">
            <Tabs>
              <Tab id="AddNap.Tiles.Tab" label="Tiles">
                <Group id="AddNap.Tiles.Group" label="Kafle" icon="Icon.16x16">
                  <Control xsi:type="Button" id="AddNap.Tiles.ShowPane"
                           label="Otwórz panel"
                           tooltip="Pokaż panel kafli"
                           icon="Icon.16x16">
                    <Action xsi:type="ShowTaskpane">
                      <SourceLocation resid="TaskPane.Url"/>
                    </Action>
                  </Control>

                  <Control xsi:type="Button" id="AddNap.Tiles.Insert"
                           label="Wstaw kafel"
                           tooltip="Wstaw wybrany kafel w kursor"
                           icon="Icon.16x16">
                    <Action xsi:type="ExecuteFunction">
                      <FunctionName>insertTileAtSelection</FunctionName>
                    </Action>
                  </Control>
                </Group>
              </Tab>
            </Tabs>
          </ExtensionPoint>

          <!-- Jeśli validator marudzi na EQUALS, zmień na CTRL+ALT+I -->
          <ExtensionPoint xsi:type="KeyboardShortcuts">
            <Shortcut id="AddNap.Tiles.ShortcutInsert"
                      key="CTRL+ALT+EQUALS"
                      action="AddNap.Tiles.Insert"/>
          </ExtensionPoint>
        </DesktopFormFactor>
      </Host>
    </Hosts>

    <Resources>
      <Images>
        <Image id="Icon.16x16" resid="Icon.16x16.Url"/>
      </Images>
      <Urls>
        <Url id="TaskPane.Url"  DefaultValue="https://addnap.github.io/DocxBuilderWord/web/taskpane.html"/>
        <Url id="Functions.Url" DefaultValue="https://addnap.github.io/DocxBuilderWord/web/functions.html"/>
        <Url id="Icon.16x16.Url" DefaultValue="https://addnap.github.io/DocxBuilderWord/web/assets/icon-16.png"/>
      </Urls>
      <ShortStrings>
        <String id="Group.Label" DefaultValue="Kafle"/>
      </ShortStrings>
    </Resources>
  </VersionOverrides>
</OfficeApp>
