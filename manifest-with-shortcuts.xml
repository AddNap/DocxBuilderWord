<?xml version="1.0" encoding="UTF-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
           xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides"
           xsi:type="TaskPaneApp">

  <Id>7b9e5d2d-2d3c-4a8c-9f0a-2db9a9e0a002</Id>
  <Version>1.0.0.0</Version>
  <ProviderName>AddNap</ProviderName>
  <DefaultLocale>en-US</DefaultLocale>
  <DisplayName DefaultValue="Word Tiles Add-in"/>
  <Description DefaultValue="Tiles with Jinja-style placeholders"/>

  <IconUrl DefaultValue="https://addnap.github.io/DocxBuilderWord/web/assets/icon-32.png"/>
  <HighResolutionIconUrl DefaultValue="https://addnap.github.io/DocxBuilderWord/web/assets/icon-80.png"/>
  <SupportUrl DefaultValue="https://addnap.github.io/DocxBuilderWord/"/>

  <AppDomains>
    <AppDomain>https://addnap.github.io</AppDomain>
  </AppDomains>

  <Hosts>
    <!-- Dla Word Task Pane jest 'Document' -->
    <Host Name="Document"/>
  </Hosts>

  <Requirements>
    <Sets DefaultMinVersion="1.1">
      <Set Name="WordApi" MinVersion="1.3"/>
    </Sets>
  </Requirements>

  <DefaultSettings>
    <SourceLocation DefaultValue="https://addnap.github.io/DocxBuilderWord/web/taskpane.html"/>
  </DefaultSettings>

  <Permissions>ReadWriteDocument</Permissions>

  <!-- WAŻNE: używamy przestrzeni nazw ov: -->
  <ov:VersionOverrides xsi:type="ov:VersionOverridesV1_0">
    <ov:Hosts>
      <ov:Host xsi:type="ov:Document">
        <ov:DesktopFormFactor>

          <!-- Plik funkcji dla przycisków/skórótów -->
          <ov:FunctionFile resid="Functions.Url"/>

          <!-- Wstążka -->
          <ov:ExtensionPoint xsi:type="PrimaryCommandSurface">
            <ov:Tabs>
              <ov:Tab id="AddNap.Tiles.Tab" label="Tiles">
                <ov:Group id="AddNap.Tiles.Group" label="Kafle" icon="Icon.16x16">
                  <ov:Control xsi:type="Button" id="AddNap.Tiles.ShowPane"
                              label="Otwórz panel"
                              tooltip="Pokaż panel kafli"
                              icon="Icon.16x16">
                    <ov:Action xsi:type="ShowTaskpane">
                      <ov:SourceLocation resid="TaskPane.Url"/>
                    </ov:Action>
                  </ov:Control>

                  <ov:Control xsi:type="Button" id="AddNap.Tiles.Insert"
                              label="Wstaw kafel"
                              tooltip="Wstaw wybrany kafel w kursor"
                              icon="Icon.16x16">
                    <ov:Action xsi:type="ExecuteFunction">
                      <ov:FunctionName>insertTileAtSelection</ov:FunctionName>
                    </ov:Action>
                  </ov:Control>
                </ov:Group>
              </ov:Tab>
            </ov:Tabs>
          </ov:ExtensionPoint>

          <!-- Skrót: jeśli validator marudzi na EQUALS, zmień na CTRL+ALT+I -->
          <ov:ExtensionPoint xsi:type="KeyboardShortcuts">
            <ov:Shortcut id="AddNap.Tiles.ShortcutInsert"
                         key="CTRL+ALT+EQUALS"
                         action="AddNap.Tiles.Insert"/>
          </ov:ExtensionPoint>

        </ov:DesktopFormFactor>
      </ov:Host>
    </ov:Hosts>

    <ov:Resources>
      <!-- Obrazy do grupy/ikon (resid użyte powyżej) -->
      <ov:Images>
        <ov:Image id="Icon.16x16" resid="Icon.16x16.Url"/>
      </ov:Images>

      <!-- URL-e zasobów -->
      <ov:Urls>
        <ov:Url id="TaskPane.Url"  DefaultValue="https://addnap.github.io/DocxBuilderWord/web/taskpane.html"/>
        <ov:Url id="Functions.Url" DefaultValue="https://addnap.github.io/DocxBuilderWord/web/functions.html"/>
        <ov:Url id="Icon.16x16.Url" DefaultValue="https://addnap.github.io/DocxBuilderWord/web/assets/icon-16.png"/>
      </ov:Urls>

      <!-- (opcjonalne) krótkie stringi -->
      <ov:ShortStrings>
        <ov:String id="Group.Label" DefaultValue="Kafle"/>
      </ov:ShortStrings>
    </ov:Resources>
  </ov:VersionOverrides>
</OfficeApp>
